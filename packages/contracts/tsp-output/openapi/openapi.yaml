openapi: 3.0.0
info:
  title: (title)
  description: |-
    Project API - RESTful API following modern best practices

    Key Features:
    - URL versioning (/v1)
    - Multi-tenant architecture (path-based with /orgs/{orgId})
    - Comprehensive pagination with navigation links
    - Structured error responses with detailed validation
    - Soft delete support with restore capability
    - Batch operations for bulk processing
    - Field selection and relation inclusion
    - Full-text search and filtering
  version: 0.0.0
tags:
  - name: Health
  - name: Users
  - name: Files
  - name: Roles
  - name: API Keys
  - name: Audit Logs
  - name: Jobs
  - name: Webhooks
  - name: ExamplePosts
  - name: ExampleComments
paths:
  /health:
    get:
      operationId: Health_check
      summary: Health check
      description: |-
        Check API health status
        Returns 200 OK if the API is healthy
      parameters: []
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum:
                      - ok
                      - degraded
                      - down
                    description: Service status
                  timestamp:
                    type: string
                    format: date-time
                    description: Current timestamp
                  version:
                    type: string
                    description: API version
                  services:
                    type: object
                    properties:
                      database:
                        type: string
                        enum:
                          - ok
                          - degraded
                          - down
                      cache:
                        type: string
                        enum:
                          - ok
                          - degraded
                          - down
                      storage:
                        type: string
                        enum:
                          - ok
                          - degraded
                          - down
                    description: Additional service information
                required:
                  - status
                  - timestamp
      tags:
        - Health
  /v1/orgs/{orgId}/api-keys:
    get:
      operationId: ApiKeys_list
      summary: List API keys
      description: |-
        List all API keys in an organization

        Does not return the actual key secrets.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: page
          in: query
          required: false
          description: Page number (1-indexed)
          schema:
            type: integer
            format: int32
            default: 1
          explode: false
        - name: pageSize
          in: query
          required: false
          description: Number of items per page
          schema:
            type: integer
            format: int32
            default: 50
          explode: false
        - name: isActive
          in: query
          required: false
          description: Filter by active status
          schema:
            type: boolean
          explode: false
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/ApiKeyListResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - API Keys
    post:
      operationId: ApiKeys_create
      summary: Create API key
      description: |-
        Create a new API key

        The key secret is only returned once in the response.
        Store it securely - it cannot be retrieved again.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '201':
          description: The request has succeeded and a new resource has been created as a result.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiKeyCreatedResponse'
      tags:
        - API Keys
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateApiKeyRequest'
        description: API key data
  /v1/orgs/{orgId}/api-keys/{keyId}:
    get:
      operationId: ApiKeys_get
      summary: Get API key
      description: |-
        Get an API key by ID

        Does not return the actual key secret.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: keyId
          in: path
          required: true
          description: API key ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/ApiKeyResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - API Keys
    patch:
      operationId: ApiKeys_update
      summary: Update API key
      description: |-
        Update an API key

        Can update name, description, permissions, and active status.
        Cannot change the key secret - create a new key instead.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: keyId
          in: path
          required: true
          description: API key ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/ApiKeyResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - API Keys
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateApiKeyRequest'
        description: Update data
    delete:
      operationId: ApiKeys_revoke
      summary: Revoke API key
      description: |-
        Revoke (delete) an API key

        The key will immediately stop working.
        This action cannot be undone.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: keyId
          in: path
          required: true
          description: API key ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '204':
          description: 'There is no content to send for this request, but the headers may be useful. '
      tags:
        - API Keys
  /v1/orgs/{orgId}/api-keys/{keyId}/rotate:
    post:
      operationId: ApiKeys_rotate
      summary: Rotate API key
      description: |-
        Rotate an API key

        Creates a new key secret while keeping the same key ID.
        The old secret immediately stops working.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: keyId
          in: path
          required: true
          description: API key ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/ApiKeyCreatedResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - API Keys
  /v1/orgs/{orgId}/audit-logs:
    get:
      operationId: AuditLogs_list
      summary: Query audit logs
      description: |-
        Query audit logs

        Search and filter audit events. Supports pagination.
        Results are sorted by timestamp descending (newest first).
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: page
          in: query
          required: false
          description: Page number (1-indexed)
          schema:
            type: integer
            format: int32
            default: 1
          explode: false
        - name: pageSize
          in: query
          required: false
          description: 'Number of items per page (max: 100)'
          schema:
            type: integer
            format: int32
            default: 50
          explode: false
        - name: eventType
          in: query
          required: false
          description: Filter by event type (e.g., "user.created", "user.*")
          schema:
            type: string
          explode: false
        - name: actorId
          in: query
          required: false
          description: Filter by actor ID
          schema:
            type: string
          explode: false
        - name: actorType
          in: query
          required: false
          description: Filter by actor type
          schema:
            $ref: '#/components/schemas/AuditActorType'
          explode: false
        - name: resourceType
          in: query
          required: false
          description: Filter by resource type (e.g., "user", "invoice")
          schema:
            type: string
          explode: false
        - name: resourceId
          in: query
          required: false
          description: Filter by resource ID
          schema:
            type: string
          explode: false
        - name: timestampAfter
          in: query
          required: false
          description: Filter events after this timestamp
          schema:
            type: string
            format: date-time
          explode: false
        - name: timestampBefore
          in: query
          required: false
          description: Filter events before this timestamp
          schema:
            type: string
            format: date-time
          explode: false
        - name: ipAddress
          in: query
          required: false
          description: Filter by IP address
          schema:
            type: string
          explode: false
        - name: requestId
          in: query
          required: false
          description: Filter by request ID
          schema:
            type: string
          explode: false
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/AuditLogListResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Audit Logs
  /v1/orgs/{orgId}/audit-logs/export:
    post:
      operationId: AuditLogs_export
      summary: Export audit logs
      description: |-
        Export audit logs

        Returns a download URL for audit logs in CSV or JSON format.
        For large exports, returns 202 Accepted with a job ID.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          downloadUrl:
                            type: string
                            description: Download URL (signed, expires in 1 hour)
                          eventCount:
                            type: integer
                            format: int32
                            description: Number of events exported
                          expiresAt:
                            type: string
                            format: date-time
                            description: When the URL expires
                        required:
                          - downloadUrl
                          - eventCount
                          - expiresAt
                      meta:
                        $ref: '#/components/schemas/ResponseMeta'
                    required:
                      - data
                      - meta
                  - $ref: '#/components/schemas/ErrorResponse'
        '202':
          description: The request has been accepted for processing, but processing has not yet completed.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AsyncJobResponse'
      tags:
        - Audit Logs
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                format:
                  type: string
                  enum:
                    - csv
                    - json
                  description: Export format
                timestampAfter:
                  type: string
                  format: date-time
                  description: Filter events after this timestamp
                timestampBefore:
                  type: string
                  format: date-time
                  description: Filter events before this timestamp
                eventTypes:
                  type: array
                  items:
                    type: string
                  description: Event types to include (empty = all)
              required:
                - format
        description: Export configuration
  /v1/orgs/{orgId}/audit-logs/{eventId}:
    get:
      operationId: AuditLogs_get
      summary: Get audit log entry
      description: Get a single audit log entry
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: eventId
          in: path
          required: true
          description: Event ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/AuditLogResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Audit Logs
  /v1/orgs/{orgId}/example-posts:
    get:
      operationId: ExamplePosts_list
      summary: List example posts
      description: |-
        List posts in an organization
        Supports pagination, filtering, sorting, and field selection
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: page
          in: query
          required: false
          description: Page number (1-indexed)
          schema:
            type: integer
            format: int32
            default: 1
          explode: false
        - name: pageSize
          in: query
          required: false
          description: 'Number of items per page (max: 100)'
          schema:
            type: integer
            format: int32
            default: 50
          explode: false
        - name: orderBy
          in: query
          required: false
          description: Sort order (e.g., "-createdAt,title" for desc createdAt, then asc title)
          schema:
            type: string
          explode: false
        - name: fields
          in: query
          required: false
          description: Comma-separated list of fields to return (e.g., "id,title,status")
          schema:
            type: string
          explode: false
        - name: include
          in: query
          required: false
          description: Comma-separated list of relations to include (e.g., "comments")
          schema:
            type: string
          explode: false
        - name: search
          in: query
          required: false
          description: Full-text search query
          schema:
            type: string
          explode: false
        - name: status
          in: query
          required: false
          description: Filter by post status (exact match)
          schema:
            $ref: '#/components/schemas/ExamplePostStatus'
          explode: false
        - name: statusNe
          in: query
          required: false
          description: Filter by status NOT equal to value
          schema:
            type: string
          explode: false
        - name: statusIn
          in: query
          required: false
          description: Filter by status IN list (comma-separated values)
          schema:
            type: string
          explode: false
        - name: authorId
          in: query
          required: false
          description: Filter by author ID
          schema:
            type: string
          explode: false
        - name: titleContains
          in: query
          required: false
          description: Filter by title contains
          schema:
            type: string
          explode: false
        - name: contentContains
          in: query
          required: false
          description: Filter by content contains
          schema:
            type: string
          explode: false
        - name: createdAfter
          in: query
          required: false
          description: Filter posts created after this timestamp
          schema:
            type: string
            format: date-time
          explode: false
        - name: createdBefore
          in: query
          required: false
          description: Filter posts created before this timestamp
          schema:
            type: string
            format: date-time
          explode: false
        - name: publishedAfter
          in: query
          required: false
          description: Filter posts published after this timestamp
          schema:
            type: string
            format: date-time
          explode: false
        - name: publishedBefore
          in: query
          required: false
          description: Filter posts published before this timestamp
          schema:
            type: string
            format: date-time
          explode: false
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/ExamplePostListResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - ExamplePosts
    post:
      operationId: ExamplePosts_create
      summary: Create example post
      description: Create a new post
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '201':
          description: The request has succeeded and a new resource has been created as a result.
          headers:
            location:
              required: true
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExamplePostResponse'
      tags:
        - ExamplePosts
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateExamplePostRequest'
        description: Post creation data
  /v1/orgs/{orgId}/example-posts/batch:
    post:
      operationId: ExamplePosts_batchCreate
      summary: Batch create example posts
      description: Batch create posts
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '201':
          description: The request has succeeded and a new resource has been created as a result.
          content:
            application/json:
              schema:
                type: object
                required:
                  - results
                  - summary
                  - meta
                properties:
                  results:
                    type: array
                    items:
                      type: object
                      required:
                        - index
                        - status
                      properties:
                        index:
                          type: integer
                          format: int32
                          description: Index of the item in the original request array
                        status:
                          type: string
                          enum:
                            - success
                            - error
                            - skipped
                          description: Status of the operation for this item
                        data:
                          allOf:
                            - $ref: '#/components/schemas/ExamplePost'
                          description: The created/updated data (present if status is success)
                        error:
                          type: object
                          properties:
                            code:
                              type: string
                              description: Error code
                            message:
                              type: string
                              description: Error message
                          required:
                            - code
                            - message
                          description: Error details (present if status is error)
                        input:
                          type: object
                          additionalProperties: {}
                          description: Original input (included for failed items to help with retry/debugging)
                      description: Result of a single item in a batch operation
                    description: Results for each item in the batch
                  summary:
                    allOf:
                      - $ref: '#/components/schemas/BatchSummary'
                    description: Summary of operation results
                  meta:
                    allOf:
                      - $ref: '#/components/schemas/ResponseMeta'
                    description: Response metadata
                description: |-
                  Generic batch response envelope

                  Uses results array with status field for each item, matching documentation
      tags:
        - ExamplePosts
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                items:
                  type: array
                  items:
                    $ref: '#/components/schemas/CreateExamplePostRequest'
                options:
                  $ref: '#/components/schemas/BatchOptions'
              required:
                - items
        description: Batch create request
    patch:
      operationId: ExamplePosts_batchUpdate
      summary: Batch update example posts
      description: Batch update posts
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - type: object
                    required:
                      - results
                      - summary
                      - meta
                    properties:
                      results:
                        type: array
                        items:
                          type: object
                          required:
                            - index
                            - status
                          properties:
                            index:
                              type: integer
                              format: int32
                              description: Index of the item in the original request array
                            status:
                              type: string
                              enum:
                                - success
                                - error
                                - skipped
                              description: Status of the operation for this item
                            data:
                              allOf:
                                - $ref: '#/components/schemas/ExamplePost'
                              description: The created/updated data (present if status is success)
                            error:
                              type: object
                              properties:
                                code:
                                  type: string
                                  description: Error code
                                message:
                                  type: string
                                  description: Error message
                              required:
                                - code
                                - message
                              description: Error details (present if status is error)
                            input:
                              type: object
                              additionalProperties: {}
                              description: Original input (included for failed items to help with retry/debugging)
                          description: Result of a single item in a batch operation
                        description: Results for each item in the batch
                      summary:
                        allOf:
                          - $ref: '#/components/schemas/BatchSummary'
                        description: Summary of operation results
                      meta:
                        allOf:
                          - $ref: '#/components/schemas/ResponseMeta'
                        description: Response metadata
                    description: |-
                      Generic batch response envelope

                      Uses results array with status field for each item, matching documentation
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - ExamplePosts
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                items:
                  type: array
                  items:
                    type: object
                    properties:
                      id:
                        type: string
                      updates:
                        $ref: '#/components/schemas/UpdateExamplePostRequest'
                    required:
                      - id
                      - updates
                options:
                  $ref: '#/components/schemas/BatchOptions'
        description: Batch update request
  /v1/orgs/{orgId}/example-posts/batch/soft-delete:
    post:
      operationId: ExamplePosts_batchSoftDelete
      summary: Batch soft delete example posts
      description: Batch soft delete posts
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/BatchDeleteResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - ExamplePosts
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                ids:
                  type: array
                  items:
                    type: string
                options:
                  $ref: '#/components/schemas/BatchOptions'
              required:
                - ids
        description: Post IDs to soft delete
  /v1/orgs/{orgId}/example-posts/{id}:
    get:
      operationId: ExamplePosts_get
      summary: Get example post
      description: Get a single post by ID
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: id
          in: path
          required: true
          description: Post ID
          schema:
            type: string
        - name: fields
          in: query
          required: false
          description: Comma-separated list of fields to return
          schema:
            type: string
          explode: false
        - name: include
          in: query
          required: false
          description: Comma-separated list of relations to include
          schema:
            type: string
          explode: false
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/ExamplePostResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - ExamplePosts
    patch:
      operationId: ExamplePosts_update
      summary: Update example post
      description: Update a post (partial update)
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: id
          in: path
          required: true
          description: Post ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/ExamplePostResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - ExamplePosts
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateExamplePostRequest'
        description: Post update data
    delete:
      operationId: ExamplePosts_delete
      summary: Soft delete example post
      description: |-
        Soft delete a post (default delete behavior)
        Post is marked as deleted but can be restored
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: id
          in: path
          required: true
          description: Post ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/SoftDeleteResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - ExamplePosts
  /v1/orgs/{orgId}/example-posts/{id}/permanent:
    delete:
      operationId: ExamplePosts_deletePermanent
      summary: Permanently delete example post
      description: |-
        Permanently delete a post (hard delete)
        Post is permanently removed and cannot be restored
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: id
          in: path
          required: true
          description: Post ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '204':
          description: 'There is no content to send for this request, but the headers may be useful. '
      tags:
        - ExamplePosts
  /v1/orgs/{orgId}/example-posts/{id}/restore:
    post:
      operationId: ExamplePosts_restore
      summary: Restore example post
      description: Restore a soft-deleted post
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: id
          in: path
          required: true
          description: Post ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/ExamplePostResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - ExamplePosts
  /v1/orgs/{orgId}/example-posts/{postId}/example-comments:
    get:
      operationId: ExampleComments_list
      summary: List comments for a post
      description: |-
        List comments for a post
        Supports pagination, filtering, and sorting
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: postId
          in: path
          required: true
          description: Parent post ID
          schema:
            type: string
        - name: page
          in: query
          required: false
          description: Page number (1-indexed)
          schema:
            type: integer
            format: int32
            default: 1
          explode: false
        - name: pageSize
          in: query
          required: false
          description: 'Number of items per page (max: 100)'
          schema:
            type: integer
            format: int32
            default: 50
          explode: false
        - name: orderBy
          in: query
          required: false
          description: Sort order (e.g., "-createdAt" for newest first)
          schema:
            type: string
          explode: false
        - name: fields
          in: query
          required: false
          description: Comma-separated list of fields to return
          schema:
            type: string
          explode: false
        - name: authorId
          in: query
          required: false
          description: Filter by author ID
          schema:
            type: string
          explode: false
        - name: contentContains
          in: query
          required: false
          description: Filter by content contains
          schema:
            type: string
          explode: false
        - name: createdAfter
          in: query
          required: false
          description: Filter comments created after this timestamp
          schema:
            type: string
            format: date-time
          explode: false
        - name: createdBefore
          in: query
          required: false
          description: Filter comments created before this timestamp
          schema:
            type: string
            format: date-time
          explode: false
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/ExampleCommentListResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - ExampleComments
    post:
      operationId: ExampleComments_create
      summary: Create comment on post
      description: Create a new comment on a post
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: postId
          in: path
          required: true
          description: Parent post ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '201':
          description: The request has succeeded and a new resource has been created as a result.
          headers:
            location:
              required: true
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExampleCommentResponse'
      tags:
        - ExampleComments
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateExampleCommentRequest'
        description: Comment creation data
  /v1/orgs/{orgId}/example-posts/{postId}/example-comments/batch:
    post:
      operationId: ExampleComments_batchCreate
      summary: Batch create comments
      description: Batch create comments
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: postId
          in: path
          required: true
          description: Parent post ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '201':
          description: The request has succeeded and a new resource has been created as a result.
          content:
            application/json:
              schema:
                type: object
                required:
                  - results
                  - summary
                  - meta
                properties:
                  results:
                    type: array
                    items:
                      type: object
                      required:
                        - index
                        - status
                      properties:
                        index:
                          type: integer
                          format: int32
                          description: Index of the item in the original request array
                        status:
                          type: string
                          enum:
                            - success
                            - error
                            - skipped
                          description: Status of the operation for this item
                        data:
                          allOf:
                            - $ref: '#/components/schemas/ExampleComment'
                          description: The created/updated data (present if status is success)
                        error:
                          type: object
                          properties:
                            code:
                              type: string
                              description: Error code
                            message:
                              type: string
                              description: Error message
                          required:
                            - code
                            - message
                          description: Error details (present if status is error)
                        input:
                          type: object
                          additionalProperties: {}
                          description: Original input (included for failed items to help with retry/debugging)
                      description: Result of a single item in a batch operation
                    description: Results for each item in the batch
                  summary:
                    allOf:
                      - $ref: '#/components/schemas/BatchSummary'
                    description: Summary of operation results
                  meta:
                    allOf:
                      - $ref: '#/components/schemas/ResponseMeta'
                    description: Response metadata
                description: |-
                  Generic batch response envelope

                  Uses results array with status field for each item, matching documentation
      tags:
        - ExampleComments
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                items:
                  type: array
                  items:
                    $ref: '#/components/schemas/CreateExampleCommentRequest'
                options:
                  $ref: '#/components/schemas/BatchOptions'
              required:
                - items
        description: Batch create request
  /v1/orgs/{orgId}/example-posts/{postId}/example-comments/batch/soft-delete:
    post:
      operationId: ExampleComments_batchSoftDelete
      summary: Batch soft delete comments
      description: Batch soft delete comments
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: postId
          in: path
          required: true
          description: Parent post ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/BatchDeleteResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - ExampleComments
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                ids:
                  type: array
                  items:
                    type: string
                options:
                  $ref: '#/components/schemas/BatchOptions'
              required:
                - ids
        description: Comment IDs to soft delete
  /v1/orgs/{orgId}/example-posts/{postId}/example-comments/{id}:
    get:
      operationId: ExampleComments_get
      summary: Get comment
      description: Get a single comment by ID
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: postId
          in: path
          required: true
          description: Parent post ID
          schema:
            type: string
        - name: id
          in: path
          required: true
          description: Comment ID
          schema:
            type: string
        - name: fields
          in: query
          required: false
          description: Comma-separated list of fields to return
          schema:
            type: string
          explode: false
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/ExampleCommentResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - ExampleComments
    patch:
      operationId: ExampleComments_update
      summary: Update comment
      description: Update a comment (partial update)
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: postId
          in: path
          required: true
          description: Parent post ID
          schema:
            type: string
        - name: id
          in: path
          required: true
          description: Comment ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/ExampleCommentResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - ExampleComments
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateExampleCommentRequest'
        description: Comment update data
    delete:
      operationId: ExampleComments_delete
      summary: Soft delete comment
      description: Soft delete a comment
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: postId
          in: path
          required: true
          description: Parent post ID
          schema:
            type: string
        - name: id
          in: path
          required: true
          description: Comment ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/SoftDeleteResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - ExampleComments
  /v1/orgs/{orgId}/example-posts/{postId}/example-comments/{id}/permanent:
    delete:
      operationId: ExampleComments_deletePermanent
      summary: Permanently delete comment
      description: Permanently delete a comment (hard delete)
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: postId
          in: path
          required: true
          description: Parent post ID
          schema:
            type: string
        - name: id
          in: path
          required: true
          description: Comment ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '204':
          description: 'There is no content to send for this request, but the headers may be useful. '
      tags:
        - ExampleComments
  /v1/orgs/{orgId}/example-posts/{postId}/example-comments/{id}/restore:
    post:
      operationId: ExampleComments_restore
      summary: Restore comment
      description: Restore a soft-deleted comment
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: postId
          in: path
          required: true
          description: Parent post ID
          schema:
            type: string
        - name: id
          in: path
          required: true
          description: Comment ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/ExampleCommentResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - ExampleComments
  /v1/orgs/{orgId}/files:
    get:
      operationId: Files_list
      summary: List files
      description: |-
        List files in an organization

        Returns paginated list of files with optional filtering.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: page
          in: query
          required: false
          description: Page number (1-indexed)
          schema:
            type: integer
            format: int32
            default: 1
          explode: false
        - name: pageSize
          in: query
          required: false
          description: 'Number of items per page (max: 100)'
          schema:
            type: integer
            format: int32
            default: 50
          explode: false
        - name: orderBy
          in: query
          required: false
          description: Sort order (e.g., "-uploadedAt,filename")
          schema:
            type: string
          explode: false
        - name: fields
          in: query
          required: false
          description: Comma-separated list of fields to return
          schema:
            type: string
          explode: false
        - name: mimeType
          in: query
          required: false
          description: Filter by MIME type
          schema:
            type: string
          explode: false
        - name: virusScanStatus
          in: query
          required: false
          description: Filter by virus scan status
          schema:
            $ref: '#/components/schemas/VirusScanStatus'
          explode: false
        - name: access
          in: query
          required: false
          description: Filter by access level
          schema:
            $ref: '#/components/schemas/FileAccess'
          explode: false
        - name: uploadedAfter
          in: query
          required: false
          description: Filter files uploaded after this timestamp
          schema:
            type: string
            format: date-time
          explode: false
        - name: uploadedBefore
          in: query
          required: false
          description: Filter files uploaded before this timestamp
          schema:
            type: string
            format: date-time
          explode: false
        - name: uploadedBy
          in: query
          required: false
          description: Filter by uploader user ID
          schema:
            type: string
          explode: false
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/FileListResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Files
    post:
      operationId: Files_directUpload
      summary: Direct file upload
      description: |-
        Direct file upload (multipart/form-data)

        For simple uploads of small files (< 10 MB).
        File is uploaded directly to the API server.

        Note: For larger files or high volume, use presigned URL upload.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '201':
          description: The request has succeeded and a new resource has been created as a result.
          headers:
            location:
              required: true
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FileResponse'
      tags:
        - Files
  /v1/orgs/{orgId}/files/uploads:
    post:
      operationId: Files_initiateUpload
      summary: Initiate presigned URL upload
      description: |-
        Initiate a presigned URL upload

        Returns a presigned URL for direct upload to storage (S3/R2/GCS).
        Client uploads directly to storage, then confirms with the API.

        Flow:
        1. POST /files/uploads - Get presigned URL
        2. PUT {presignedUrl} - Upload directly to storage
        3. POST /files/uploads/{uploadId}/confirm - Confirm upload
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/InitiateUploadResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Files
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InitiateUploadRequest'
        description: Upload request with file metadata
  /v1/orgs/{orgId}/files/uploads/{uploadId}/confirm:
    post:
      operationId: Files_confirmUpload
      summary: Confirm presigned URL upload
      description: |-
        Confirm a presigned URL upload

        Called after client successfully uploads to the presigned URL.
        Triggers virus scanning and creates the file record.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: uploadId
          in: path
          required: true
          description: Upload ID from initiate response
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '201':
          description: The request has succeeded and a new resource has been created as a result.
          headers:
            location:
              required: true
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FileResponse'
      tags:
        - Files
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConfirmUploadRequest'
        description: Confirmation data
  /v1/orgs/{orgId}/files/{fileId}:
    get:
      operationId: Files_get
      summary: Get file
      description: |-
        Get a single file by ID

        Returns file metadata including a fresh signed URL for download.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: fileId
          in: path
          required: true
          description: File ID
          schema:
            type: string
        - name: fields
          in: query
          required: false
          description: Comma-separated list of fields to return
          schema:
            type: string
          explode: false
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/FileResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Files
    delete:
      operationId: Files_delete
      summary: Delete file
      description: |-
        Delete a file (soft delete)

        File is marked as deleted but retained for audit purposes.
        Storage is cleaned up after retention period.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: fileId
          in: path
          required: true
          description: File ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/FileDeleteResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Files
  /v1/orgs/{orgId}/files/{fileId}/download:
    get:
      operationId: Files_download
      summary: Download file
      description: |-
        Download a file

        Returns a redirect to a signed URL for the file.
        The signed URL expires in 5 minutes.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: fileId
          in: path
          required: true
          description: File ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '302':
          description: Redirection
          headers:
            location:
              required: true
              schema:
                type: string
      tags:
        - Files
  /v1/orgs/{orgId}/files/{fileId}/permanent:
    delete:
      operationId: Files_deletePermanent
      summary: Permanently delete file
      description: |-
        Permanently delete a file (hard delete)

        Immediately removes file from storage.
        Use with caution - cannot be undone.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: fileId
          in: path
          required: true
          description: File ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '204':
          description: 'There is no content to send for this request, but the headers may be useful. '
      tags:
        - Files
  /v1/orgs/{orgId}/jobs:
    get:
      operationId: Jobs_list
      summary: List jobs
      description: |-
        List async jobs

        Returns jobs for the current tenant.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: page
          in: query
          required: false
          description: Page number (1-indexed)
          schema:
            type: integer
            format: int32
            default: 1
          explode: false
        - name: pageSize
          in: query
          required: false
          description: Number of items per page
          schema:
            type: integer
            format: int32
            default: 50
          explode: false
        - name: status
          in: query
          required: false
          description: Filter by job status
          schema:
            $ref: '#/components/schemas/JobStatus'
          explode: false
        - name: type
          in: query
          required: false
          description: Filter by job type
          schema:
            type: string
          explode: false
        - name: createdAfter
          in: query
          required: false
          description: Filter jobs created after this timestamp
          schema:
            type: string
            format: date-time
          explode: false
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/JobListResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Jobs
  /v1/orgs/{orgId}/jobs/{jobId}:
    get:
      operationId: Jobs_get
      summary: Get job status
      description: |-
        Get job status

        Poll this endpoint to check progress of async operations.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: jobId
          in: path
          required: true
          description: Job ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/JobResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Jobs
  /v1/orgs/{orgId}/jobs/{jobId}/cancel:
    post:
      operationId: Jobs_cancel
      summary: Cancel job
      description: |-
        Cancel a job

        Only pending or processing jobs can be cancelled.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: jobId
          in: path
          required: true
          description: Job ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/JobResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Jobs
  /v1/orgs/{orgId}/roles:
    get:
      operationId: Roles_list
      summary: List roles
      description: |-
        List all roles in an organization

        Returns both system roles and custom roles.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: page
          in: query
          required: false
          description: Page number (1-indexed)
          schema:
            type: integer
            format: int32
            default: 1
          explode: false
        - name: pageSize
          in: query
          required: false
          description: Number of items per page
          schema:
            type: integer
            format: int32
            default: 50
          explode: false
        - name: isSystemRole
          in: query
          required: false
          description: Filter by system role status
          schema:
            type: boolean
          explode: false
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/RoleListResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Roles
    post:
      operationId: Roles_create
      summary: Create role
      description: |-
        Create a custom role

        System roles cannot be created via API.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '201':
          description: The request has succeeded and a new resource has been created as a result.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RoleResponse'
      tags:
        - Roles
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateRoleRequest'
        description: Role data
  /v1/orgs/{orgId}/roles/{roleId}:
    get:
      operationId: Roles_get
      summary: Get role
      description: Get a role by ID
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: roleId
          in: path
          required: true
          description: Role ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/RoleResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Roles
    patch:
      operationId: Roles_update
      summary: Update role
      description: |-
        Update a custom role

        System roles cannot be modified.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: roleId
          in: path
          required: true
          description: Role ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/RoleResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Roles
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateRoleRequest'
        description: Role update data
    delete:
      operationId: Roles_delete
      summary: Delete role
      description: |-
        Delete a custom role

        System roles cannot be deleted.
        Fails if role is assigned to any users.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: roleId
          in: path
          required: true
          description: Role ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '204':
          description: 'There is no content to send for this request, but the headers may be useful. '
      tags:
        - Roles
  /v1/orgs/{orgId}/users:
    get:
      operationId: Users_list
      summary: List users
      description: |-
        List users in an organization
        Supports pagination, filtering, sorting, and field selection
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: page
          in: query
          required: false
          description: Page number (1-indexed)
          schema:
            type: integer
            format: int32
            default: 1
          explode: false
        - name: pageSize
          in: query
          required: false
          description: 'Number of items per page (max: 100)'
          schema:
            type: integer
            format: int32
            default: 50
          explode: false
        - name: orderBy
          in: query
          required: false
          description: Sort order (e.g., "-createdAt,name" for desc createdAt, then asc name)
          schema:
            type: string
          explode: false
        - name: fields
          in: query
          required: false
          description: Comma-separated list of fields to return (e.g., "id,email,name")
          schema:
            type: string
          explode: false
        - name: include
          in: query
          required: false
          description: Comma-separated list of relations to include (e.g., "addresses,sessions")
          schema:
            type: string
          explode: false
        - name: search
          in: query
          required: false
          description: Full-text search query
          schema:
            type: string
          explode: false
        - name: status
          in: query
          required: false
          description: Filter by user status (exact match)
          schema:
            type: string
          explode: false
        - name: statusNe
          in: query
          required: false
          description: Filter by status NOT equal to value
          schema:
            type: string
          explode: false
        - name: statusIn
          in: query
          required: false
          description: Filter by status IN list (comma-separated values)
          schema:
            type: string
          explode: false
        - name: isVerified
          in: query
          required: false
          description: Filter by verified status
          schema:
            type: boolean
          explode: false
        - name: isActive
          in: query
          required: false
          description: Filter by active status
          schema:
            type: boolean
          explode: false
        - name: role
          in: query
          required: false
          description: Filter by role (exact match)
          schema:
            type: string
          explode: false
        - name: roleIn
          in: query
          required: false
          description: Filter by role IN list (comma-separated values)
          schema:
            type: string
          explode: false
        - name: emailContains
          in: query
          required: false
          description: Filter by email contains
          schema:
            type: string
          explode: false
        - name: emailStartsWith
          in: query
          required: false
          description: Filter by email starts with
          schema:
            type: string
          explode: false
        - name: emailEndsWith
          in: query
          required: false
          description: Filter by email ends with
          schema:
            type: string
          explode: false
        - name: nameContains
          in: query
          required: false
          description: Filter by name contains
          schema:
            type: string
          explode: false
        - name: createdAfter
          in: query
          required: false
          description: Filter users created after this timestamp
          schema:
            type: string
            format: date-time
          explode: false
        - name: createdBefore
          in: query
          required: false
          description: Filter users created before this timestamp
          schema:
            type: string
            format: date-time
          explode: false
        - name: updatedAfter
          in: query
          required: false
          description: Filter users updated after this timestamp
          schema:
            type: string
            format: date-time
          explode: false
        - name: updatedBefore
          in: query
          required: false
          description: Filter users updated before this timestamp
          schema:
            type: string
            format: date-time
          explode: false
        - name: lastLoginAfter
          in: query
          required: false
          description: Filter users last login after this timestamp
          schema:
            type: string
            format: date-time
          explode: false
        - name: lastLoginBefore
          in: query
          required: false
          description: Filter users last login before this timestamp
          schema:
            type: string
            format: date-time
          explode: false
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/UserListResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Users
    post:
      operationId: Users_create
      summary: Create user
      description: Create a new user
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '201':
          description: The request has succeeded and a new resource has been created as a result.
          headers:
            location:
              required: true
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserResponse'
      tags:
        - Users
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateUserRequest'
        description: User creation data
  /v1/orgs/{orgId}/users/batch:
    post:
      operationId: Users_batchCreate
      summary: Batch create users
      description: Batch create users
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '201':
          description: The request has succeeded and a new resource has been created as a result.
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      created:
                        type: array
                        items:
                          $ref: '#/components/schemas/User'
                      failed:
                        type: array
                        items:
                          type: object
                          properties:
                            index:
                              type: integer
                              format: int32
                            error:
                              $ref: '#/components/schemas/Error'
                          required:
                            - index
                            - error
                    required:
                      - created
                      - failed
                  meta:
                    $ref: '#/components/schemas/ResponseMeta'
                required:
                  - data
                  - meta
      tags:
        - Users
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                users:
                  type: array
                  items:
                    $ref: '#/components/schemas/CreateUserRequest'
              required:
                - users
        description: Array of users to create
    patch:
      operationId: Users_batchUpdate
      summary: Batch update users
      description: Batch update users
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          updated:
                            type: array
                            items:
                              $ref: '#/components/schemas/User'
                          failed:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: string
                                error:
                                  $ref: '#/components/schemas/Error'
                              required:
                                - id
                                - error
                        required:
                          - updated
                          - failed
                      meta:
                        $ref: '#/components/schemas/ResponseMeta'
                    required:
                      - data
                      - meta
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Users
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                users:
                  type: array
                  items:
                    type: object
                    properties:
                      id:
                        type: string
                      updates:
                        $ref: '#/components/schemas/UpdateUserRequest'
                    required:
                      - id
                      - updates
        description: Array of user updates
  /v1/orgs/{orgId}/users/batch/soft-delete:
    post:
      operationId: Users_batchSoftDelete
      summary: Batch soft delete users
      description: Batch soft delete users
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          deleted:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: string
                                deletedAt:
                                  type: string
                                  format: date-time
                              required:
                                - id
                                - deletedAt
                          failed:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: string
                                error:
                                  $ref: '#/components/schemas/Error'
                              required:
                                - id
                                - error
                        required:
                          - deleted
                          - failed
                      meta:
                        $ref: '#/components/schemas/ResponseMeta'
                    required:
                      - data
                      - meta
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Users
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                ids:
                  type: array
                  items:
                    type: string
              required:
                - ids
        description: User IDs to soft delete
  /v1/orgs/{orgId}/users/{id}:
    get:
      operationId: Users_get
      summary: Get user
      description: Get a single user by ID
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: id
          in: path
          required: true
          description: User ID
          schema:
            type: string
        - name: fields
          in: query
          required: false
          description: Comma-separated list of fields to return
          schema:
            type: string
          explode: false
        - name: include
          in: query
          required: false
          description: Comma-separated list of relations to include
          schema:
            type: string
          explode: false
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/UserResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Users
    patch:
      operationId: Users_update
      summary: Update user
      description: Update a user (partial update)
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: id
          in: path
          required: true
          description: User ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/UserResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Users
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateUserRequest'
        description: User update data
    delete:
      operationId: Users_delete
      summary: Soft delete user
      description: |-
        Soft delete a user (default delete behavior)
        User is marked as deleted but can be restored
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: id
          in: path
          required: true
          description: User ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/SoftDeleteResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Users
  /v1/orgs/{orgId}/users/{id}/actions/reset-password:
    post:
      operationId: Users_resetPassword
      summary: Reset user password
      description: 'Custom action: Reset user password'
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: id
          in: path
          required: true
          description: User ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          userId:
                            type: string
                          resetTokenSent:
                            type: boolean
                          expiresAt:
                            type: string
                            format: date-time
                        required:
                          - userId
                          - resetTokenSent
                          - expiresAt
                      meta:
                        $ref: '#/components/schemas/ResponseMeta'
                    required:
                      - data
                      - meta
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Users
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  description: Email to send password reset link to
                sendEmail:
                  type: boolean
                  description: Whether to send email notification
        description: Password reset options
  /v1/orgs/{orgId}/users/{id}/permanent:
    delete:
      operationId: Users_deletePermanent
      summary: Permanently delete user
      description: |-
        Permanently delete a user (hard delete)
        User is permanently removed and cannot be restored
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: id
          in: path
          required: true
          description: User ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '204':
          description: 'There is no content to send for this request, but the headers may be useful. '
      tags:
        - Users
  /v1/orgs/{orgId}/users/{id}/restore:
    post:
      operationId: Users_restore
      summary: Restore user
      description: Restore a soft-deleted user
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: id
          in: path
          required: true
          description: User ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/UserResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Users
  /v1/orgs/{orgId}/users/{userId}/permissions:
    get:
      operationId: UserPermissionsEndpoint_get
      summary: Get user permissions
      description: |-
        Get user's effective permissions in this tenant

        Returns all roles and the combined effective permissions.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: userId
          in: path
          required: true
          description: User ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/UserPermissionsResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Roles
  /v1/orgs/{orgId}/users/{userId}/roles:
    get:
      operationId: UserRoles_list
      summary: List user roles
      description: List roles assigned to a user in this tenant
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: userId
          in: path
          required: true
          description: User ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/UserRole'
                      meta:
                        $ref: '#/components/schemas/ResponseMeta'
                    required:
                      - data
                      - meta
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Roles
    post:
      operationId: UserRoles_assign
      summary: Assign role to user
      description: Assign a role to a user
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: userId
          in: path
          required: true
          description: User ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '201':
          description: The request has succeeded and a new resource has been created as a result.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserRoleResponse'
      tags:
        - Roles
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AssignRoleRequest'
        description: Role assignment
  /v1/orgs/{orgId}/users/{userId}/roles/{roleId}:
    delete:
      operationId: UserRoles_remove
      summary: Remove role from user
      description: Remove a role from a user
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: userId
          in: path
          required: true
          description: User ID
          schema:
            type: string
        - name: roleId
          in: path
          required: true
          description: Role ID to remove
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '204':
          description: 'There is no content to send for this request, but the headers may be useful. '
      tags:
        - Roles
  /v1/orgs/{orgId}/webhooks:
    get:
      operationId: Webhooks_list
      summary: List webhooks
      description: List all webhooks in an organization
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: page
          in: query
          required: false
          description: Page number (1-indexed)
          schema:
            type: integer
            format: int32
            default: 1
          explode: false
        - name: pageSize
          in: query
          required: false
          description: Number of items per page
          schema:
            type: integer
            format: int32
            default: 50
          explode: false
        - name: isActive
          in: query
          required: false
          description: Filter by active status
          schema:
            type: boolean
          explode: false
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/WebhookListResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Webhooks
    post:
      operationId: Webhooks_create
      summary: Create webhook
      description: |-
        Create a new webhook

        The secret is only returned once in the response.
        Store it securely for signature verification.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '201':
          description: The request has succeeded and a new resource has been created as a result.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WebhookCreatedResponse'
      tags:
        - Webhooks
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateWebhookRequest'
        description: Webhook configuration
  /v1/orgs/{orgId}/webhooks/event-types:
    get:
      operationId: Webhooks_listEventTypes
      summary: List event types
      description: |-
        Get available event types

        Returns all event types that can be subscribed to.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/WebhookEventTypesResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Webhooks
  /v1/orgs/{orgId}/webhooks/{webhookId}:
    get:
      operationId: Webhooks_get
      summary: Get webhook
      description: Get a webhook by ID
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: webhookId
          in: path
          required: true
          description: Webhook ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/WebhookResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Webhooks
    patch:
      operationId: Webhooks_update
      summary: Update webhook
      description: Update a webhook
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: webhookId
          in: path
          required: true
          description: Webhook ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/WebhookResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Webhooks
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateWebhookRequest'
        description: Update data
    delete:
      operationId: Webhooks_delete
      summary: Delete webhook
      description: Delete a webhook
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: webhookId
          in: path
          required: true
          description: Webhook ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '204':
          description: 'There is no content to send for this request, but the headers may be useful. '
      tags:
        - Webhooks
  /v1/orgs/{orgId}/webhooks/{webhookId}/deliveries:
    get:
      operationId: Webhooks_listDeliveries
      summary: List webhook deliveries
      description: |-
        List webhook deliveries

        View delivery history for debugging.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: webhookId
          in: path
          required: true
          description: Webhook ID
          schema:
            type: string
        - name: page
          in: query
          required: false
          description: Page number
          schema:
            type: integer
            format: int32
            default: 1
          explode: false
        - name: pageSize
          in: query
          required: false
          description: Items per page
          schema:
            type: integer
            format: int32
            default: 50
          explode: false
        - name: status
          in: query
          required: false
          description: Filter by status
          schema:
            $ref: '#/components/schemas/WebhookDeliveryStatus'
          explode: false
        - name: eventType
          in: query
          required: false
          description: Filter by event type
          schema:
            type: string
          explode: false
        - name: createdAfter
          in: query
          required: false
          description: Filter deliveries after this timestamp
          schema:
            type: string
            format: date-time
          explode: false
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/WebhookDeliveryListResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Webhooks
  /v1/orgs/{orgId}/webhooks/{webhookId}/deliveries/{deliveryId}:
    get:
      operationId: Webhooks_getDelivery
      summary: Get webhook delivery
      description: Get a specific delivery
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: webhookId
          in: path
          required: true
          description: Webhook ID
          schema:
            type: string
        - name: deliveryId
          in: path
          required: true
          description: Delivery ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/WebhookDeliveryResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Webhooks
  /v1/orgs/{orgId}/webhooks/{webhookId}/deliveries/{deliveryId}/retry:
    post:
      operationId: Webhooks_retryDelivery
      summary: Retry delivery
      description: |-
        Retry a failed delivery

        Manually triggers a retry for a failed delivery.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: webhookId
          in: path
          required: true
          description: Webhook ID
          schema:
            type: string
        - name: deliveryId
          in: path
          required: true
          description: Delivery ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/WebhookDeliveryResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Webhooks
  /v1/orgs/{orgId}/webhooks/{webhookId}/rotate-secret:
    post:
      operationId: Webhooks_rotateSecret
      summary: Rotate webhook secret
      description: |-
        Rotate webhook secret

        Generates a new secret. The old secret immediately stops working.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: webhookId
          in: path
          required: true
          description: Webhook ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/WebhookCreatedResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Webhooks
  /v1/orgs/{orgId}/webhooks/{webhookId}/test:
    post:
      operationId: Webhooks_test
      summary: Test webhook
      description: |-
        Test a webhook

        Sends a test event to verify the webhook is configured correctly.
      parameters:
        - name: orgId
          in: path
          required: true
          description: Organization ID
          schema:
            type: string
        - name: webhookId
          in: path
          required: true
          description: Webhook ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          success:
                            type: boolean
                            description: Whether the test was successful
                          httpStatus:
                            type: integer
                            format: int32
                            description: HTTP status code from the webhook endpoint
                          durationMs:
                            type: integer
                            format: int32
                            description: Response time in milliseconds
                          error:
                            type: string
                            description: Error message if failed
                        required:
                          - success
                      meta:
                        $ref: '#/components/schemas/ResponseMeta'
                    required:
                      - data
                      - meta
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Webhooks
  /v1/users/{userId}/switch-tenant:
    post:
      operationId: TenantSwitch_switch
      summary: Switch tenant
      description: |-
        Switch user's active tenant

        Returns a new access token scoped to the target tenant.
      parameters:
        - name: userId
          in: path
          required: true
          description: User ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/SwitchTenantResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Roles
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SwitchTenantRequest'
        description: Target tenant
  /v1/users/{userId}/tenant-roles:
    get:
      operationId: CrossTenantRoles_list
      summary: List user tenant roles
      description: |-
        List user's roles across all tenants

        Returns all tenants the user belongs to with their roles.
      parameters:
        - name: userId
          in: path
          required: true
          description: User ID
          schema:
            type: string
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/UserTenantRolesResponse'
                  - $ref: '#/components/schemas/ErrorResponse'
      tags:
        - Roles
components:
  schemas:
    ApiKey:
      type: object
      required:
        - id
        - tenantId
        - name
        - permissions
        - keyPrefix
        - isActive
        - createdBy
        - createdAt
        - updatedAt
      properties:
        id:
          type: string
          description: 'Unique API key identifier (format: key_abc123)'
          example: key_abc123
        tenantId:
          type: string
          description: Tenant this API key belongs to
          example: org_abc123
        name:
          type: string
          description: Human-readable name for the API key
          example: CI/CD Pipeline
        description:
          type: string
          description: Description of what this key is used for
          example: Automated deployment service
        permissions:
          type: array
          items:
            type: string
          description: 'Permissions granted to this key (format: resource:action)'
          example:
            - deployments:write
            - logs:read
        keyPrefix:
          type: string
          description: Masked key prefix for identification (e.g., "key_abc...xyz")
          example: key_abc...xyz
        lastUsedAt:
          type: string
          format: date-time
          description: When the key was last used (null if never used)
        lastUsedIp:
          type: string
          description: IP address from which the key was last used
        expiresAt:
          type: string
          format: date-time
          description: When the API key expires (null for no expiration)
        isActive:
          type: boolean
          description: Whether the key is currently active
        createdBy:
          type: string
          description: User who created this API key
          example: usr_admin123
        createdAt:
          type: string
          format: date-time
          description: When the API key was created
        updatedAt:
          type: string
          format: date-time
          description: When the API key was last updated
      description: |-
        API Key resource model

        Used for service accounts and automation.
        The actual key value is only returned once at creation.
    ApiKeyCreatedResponse:
      type: object
      required:
        - data
        - meta
      properties:
        data:
          $ref: '#/components/schemas/ApiKeyWithSecret'
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: API key creation response (includes secret once)
    ApiKeyListResponse:
      type: object
      required:
        - data
        - pagination
        - meta
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/ApiKey'
        pagination:
          $ref: '#/components/schemas/Pagination'
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: API key list response
    ApiKeyResponse:
      type: object
      required:
        - data
        - meta
      properties:
        data:
          $ref: '#/components/schemas/ApiKey'
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: API key response (without secret)
    ApiKeyWithSecret:
      type: object
      required:
        - id
        - tenantId
        - name
        - permissions
        - key
        - createdAt
      properties:
        id:
          type: string
          description: Unique API key identifier
          example: key_abc123
        tenantId:
          type: string
          description: Tenant this API key belongs to
          example: org_abc123
        name:
          type: string
          description: Human-readable name
          example: CI/CD Pipeline
        description:
          type: string
          description: Description
        permissions:
          type: array
          items:
            type: string
          description: Permissions granted
        key:
          type: string
          description: |-
            The actual API key secret - ONLY RETURNED ONCE
            Store this securely, it cannot be retrieved again
          example: key_abc123xyz789_secret
        expiresAt:
          type: string
          format: date-time
          description: When the key expires
        createdAt:
          type: string
          format: date-time
          description: When the API key was created
      description: API Key with the actual secret (only returned on creation)
    AssignRoleRequest:
      type: object
      required:
        - roleId
      properties:
        roleId:
          type: string
          description: Role ID to assign
      description: Request to assign a role to a user
    AsyncJobResponse:
      type: object
      required:
        - jobId
        - status
        - statusUrl
        - meta
      properties:
        jobId:
          type: string
          description: Unique job identifier
        status:
          type: string
          enum:
            - pending
            - processing
            - completed
            - failed
          description: Current job status
        statusUrl:
          type: string
          description: URL to check job status
        estimatedCompletion:
          type: string
          format: date-time
          description: Estimated completion time
        meta:
          allOf:
            - $ref: '#/components/schemas/ResponseMeta'
          description: Response metadata
      description: Response for async operations that return 202 Accepted
    AuditActor:
      type: object
      required:
        - type
        - id
      properties:
        type:
          allOf:
            - $ref: '#/components/schemas/AuditActorType'
          description: Type of actor
        id:
          type: string
          description: Actor ID (user ID, service account ID, or "system")
          example: usr_123
        email:
          type: string
          description: Actor email (for users)
          example: admin@example.com
        ipAddress:
          type: string
          description: IP address of the actor
          example: 192.168.1.1
        userAgent:
          type: string
          description: User agent string
      description: Actor who performed the action
    AuditActorType:
      type: string
      enum:
        - user
        - service
        - system
      description: Actor type - who performed the action
    AuditChange:
      type: object
      required:
        - old
        - new
      properties:
        old:
          description: Value before the change
        new:
          description: Value after the change
      description: Change record for a single field
    AuditLog:
      type: object
      required:
        - eventId
        - eventType
        - timestamp
        - tenantId
        - actor
        - resource
      properties:
        eventId:
          type: string
          description: 'Unique event identifier (format: evt_abc123)'
          example: evt_abc123
        eventType:
          type: string
          description: 'Event type (format: resource.action)'
          example: user.updated
        timestamp:
          type: string
          format: date-time
          description: When the event occurred
        tenantId:
          type: string
          description: Tenant where the event occurred
          example: org_xyz789
        actor:
          allOf:
            - $ref: '#/components/schemas/AuditActor'
          description: Who performed the action
        resource:
          allOf:
            - $ref: '#/components/schemas/AuditResource'
          description: What resource was affected
        changes:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/AuditChange'
          description: Changes made (for update operations)
        resourceBefore:
          type: object
          additionalProperties: {}
          description: Full resource state before the action (for deletes, sensitive ops)
        resourceAfter:
          type: object
          additionalProperties: {}
          description: Full resource state after the action (for creates, sensitive ops)
        metadata:
          allOf:
            - $ref: '#/components/schemas/AuditMetadata'
          description: Additional context
      description: |-
        Audit log entry

        Immutable record of an action in the system.
    AuditLogListResponse:
      type: object
      required:
        - data
        - pagination
        - meta
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/AuditLog'
        pagination:
          $ref: '#/components/schemas/Pagination'
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: Audit log list response
    AuditLogResponse:
      type: object
      required:
        - data
        - meta
      properties:
        data:
          $ref: '#/components/schemas/AuditLog'
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: Single audit log response
    AuditMetadata:
      type: object
      properties:
        requestId:
          type: string
          description: Request ID for correlation
          example: req_7k3m9x2p4b
        sessionId:
          type: string
          description: Session ID
          example: ses_def456
        reason:
          type: string
          description: Reason for the action (if provided)
        extra:
          type: object
          additionalProperties: {}
          description: Additional context-specific data
      description: Additional metadata for the audit event
    AuditResource:
      type: object
      required:
        - type
        - id
      properties:
        type:
          type: string
          description: Resource type
          example: user
        id:
          type: string
          description: Resource ID
          example: usr_456
        endpoint:
          type: string
          description: API endpoint that was called
          example: /v1/orgs/org_xyz789/users/usr_456
        method:
          type: string
          description: HTTP method used
          example: PATCH
      description: Resource affected by the action
    BatchDeleteResponse:
      type: object
      required:
        - results
        - summary
        - meta
      properties:
        results:
          type: array
          items:
            $ref: '#/components/schemas/BatchDeleteResult'
          description: Results for each item in the batch
        summary:
          allOf:
            - $ref: '#/components/schemas/BatchSummary'
          description: Summary of operation results
        meta:
          allOf:
            - $ref: '#/components/schemas/ResponseMeta'
          description: Response metadata
      description: Batch delete response envelope
    BatchDeleteResult:
      type: object
      required:
        - index
        - status
      properties:
        index:
          type: integer
          format: int32
          description: Index of the item in the original request array
        status:
          type: string
          enum:
            - success
            - error
            - skipped
          description: Status of the operation for this item
        data:
          type: object
          properties:
            id:
              type: string
              description: ID of the deleted item
            deletedAt:
              type: string
              format: date-time
              description: Timestamp when the item was deleted
          required:
            - id
            - deletedAt
          description: Deleted item info (present if status is success)
        error:
          type: object
          properties:
            code:
              type: string
              description: Error code
            message:
              type: string
              description: Error message
          required:
            - code
            - message
          description: Error details (present if status is error)
      description: Batch delete result (soft delete)
    BatchOptions:
      type: object
      properties:
        atomic:
          type: boolean
          description: If true, all items succeed or all fail (transactional)
        returnRecords:
          type: boolean
          description: If true, return created/updated records in response
        skipDuplicates:
          type: boolean
          description: If true, skip items that already exist (duplicates)
        validateOnly:
          type: boolean
          description: If true, validate without actually creating/updating
      description: Options for batch operations
    BatchSummary:
      type: object
      required:
        - total
        - successful
        - failed
        - skipped
      properties:
        total:
          type: integer
          format: int32
          description: Total number of items in the request
        successful:
          type: integer
          format: int32
          description: Number of successfully processed items
        failed:
          type: integer
          format: int32
          description: Number of failed items
        skipped:
          type: integer
          format: int32
          description: Number of skipped items (e.g., duplicates)
      description: Summary of batch operation results
    ConfirmUploadRequest:
      type: object
      properties:
        etag:
          type: string
          description: 'Optional: ETag from S3 response for verification'
      description: Request to confirm an upload completed successfully
    CreateApiKeyRequest:
      type: object
      required:
        - name
        - permissions
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 100
          description: Human-readable name for the API key
        description:
          type: string
          maxLength: 500
          description: Description of what this key is used for
        permissions:
          type: array
          items:
            type: string
          minItems: 1
          description: 'Permissions to grant (format: resource:action)'
        expiresAt:
          type: string
          format: date-time
          description: When the key should expire (optional, null for no expiration)
      description: Request to create a new API key
    CreateExampleCommentRequest:
      type: object
      required:
        - content
        - authorId
      properties:
        content:
          type: string
          description: Comment content
          example: Great post! Very informative.
        authorId:
          type: string
          description: Author user ID
          example: usr_commenter789
      description: Request body for creating a new comment
    CreateExamplePostRequest:
      type: object
      required:
        - title
        - content
        - authorId
      properties:
        title:
          type: string
          description: Post title
          example: Introduction to TypeSpec
        content:
          type: string
          description: Post content (supports markdown)
          example: This is the full content of the post...
        authorId:
          type: string
          description: Author user ID
          example: usr_author123
        status:
          allOf:
            - $ref: '#/components/schemas/ExamplePostStatus'
          description: 'Post status (default: draft)'
      description: Request body for creating a new post
    CreateRoleRequest:
      type: object
      required:
        - name
        - permissions
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 100
          description: Role name
        description:
          type: string
          maxLength: 500
          description: Role description
        permissions:
          type: array
          items:
            type: string
          minItems: 1
          description: 'Permissions to grant (format: resource:action)'
      description: Request to create a custom role
    CreateUserRequest:
      type: object
      required:
        - email
        - name
        - password
      properties:
        email:
          type: string
          description: User's email address
          example: john.doe@example.com
        name:
          type: string
          description: User's full name
          example: John Doe
        password:
          type: string
          minLength: 8
          description: User's password (min 8 characters)
        isActive:
          type: boolean
          description: 'Whether the user should be active upon creation (default: true)'
      description: Request body for creating a new user
    CreateWebhookRequest:
      type: object
      required:
        - url
        - events
      properties:
        url:
          type: string
          format: uri
          description: URL to receive webhook payloads (must be HTTPS)
        name:
          type: string
          maxLength: 100
          description: Human-readable name
        description:
          type: string
          maxLength: 500
          description: Description
        events:
          type: array
          items:
            type: string
          minItems: 1
          description: Event types to subscribe to
        isActive:
          type: boolean
          description: 'Whether the webhook is active (default: true)'
      description: Request to create a webhook
    Error:
      type: object
      required:
        - code
        - message
        - requestId
      properties:
        code:
          type: string
          description: Machine-readable error code
        message:
          type: string
          description: Human-readable error message
        details:
          type: array
          items:
            $ref: '#/components/schemas/ErrorDetail'
          description: Array of detailed error information (e.g., validation errors)
        requestId:
          type: string
          description: Request ID for tracking and debugging
        documentationUrl:
          type: string
          description: URL to documentation about this error (optional)
      description: Standard error object
    ErrorDetail:
      type: object
      required:
        - field
        - code
        - message
      properties:
        field:
          type: string
          description: The field that caused the error (for validation errors)
        code:
          type: string
          description: Specific error code for this detail
        message:
          type: string
          description: Human-readable error message
        metadata:
          type: object
          additionalProperties: {}
          description: Additional metadata about the error
      description: Detailed error information for a specific field or validation
    ErrorResponse:
      type: object
      required:
        - error
      properties:
        error:
          allOf:
            - $ref: '#/components/schemas/Error'
          description: The error object
      description: Standard error response envelope
    ExampleComment:
      type: object
      required:
        - id
        - orgId
        - postId
        - content
        - authorId
        - isDeleted
        - createdAt
        - updatedAt
      properties:
        id:
          type: string
          description: 'Unique comment identifier (format: cmt_{randomString})'
          example: cmt_abc123
        orgId:
          type: string
          description: Organization ID (tenant scope)
          example: org_xyz789
        postId:
          type: string
          description: Parent post ID
          example: post_parent456
        content:
          type: string
          description: Comment content
          example: Great post! Very informative.
        authorId:
          type: string
          description: Author user ID
          example: usr_commenter789
        isDeleted:
          type: boolean
          description: Whether the comment is soft deleted
        deletedAt:
          type: string
          format: date-time
          description: Timestamp when the comment was soft deleted
        deletedBy:
          type: string
          description: User ID who deleted this comment
        createdAt:
          type: string
          format: date-time
          description: Timestamp when the comment was created
        updatedAt:
          type: string
          format: date-time
          description: Timestamp when the comment was last updated
      description: |-
        ExampleComment resource model (nested under ExamplePost)

        Demonstrates:
        - Nested sub-resource pattern (belongs to a post)
        - Multi-tenant scoping (orgId)
        - Soft delete with restore capability
    ExampleCommentListResponse:
      type: object
      required:
        - data
        - pagination
        - meta
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/ExampleComment'
        pagination:
          $ref: '#/components/schemas/Pagination'
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: Comment collection response
    ExampleCommentResponse:
      type: object
      required:
        - data
        - meta
      properties:
        data:
          $ref: '#/components/schemas/ExampleComment'
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: Single comment response
    ExamplePost:
      type: object
      required:
        - id
        - orgId
        - title
        - content
        - authorId
        - status
        - isDeleted
        - createdAt
        - updatedAt
      properties:
        id:
          type: string
          description: 'Unique post identifier (format: post_{randomString})'
          example: post_abc123
        orgId:
          type: string
          description: Organization ID (tenant scope)
          example: org_xyz789
        title:
          type: string
          description: Post title
          example: Introduction to TypeSpec
        content:
          type: string
          description: Post content (supports markdown)
          example: This is the full content of the post...
        authorId:
          type: string
          description: Author user ID
          example: usr_author123
        status:
          allOf:
            - $ref: '#/components/schemas/ExamplePostStatus'
          description: Post status
        publishedAt:
          type: string
          format: date-time
          description: Timestamp when the post was published (null if not published)
        isDeleted:
          type: boolean
          description: Whether the post is soft deleted
        deletedAt:
          type: string
          format: date-time
          description: Timestamp when the post was soft deleted (null if not deleted)
        deletedBy:
          type: string
          description: User ID who deleted this post (null if not deleted)
        createdAt:
          type: string
          format: date-time
          description: Timestamp when the post was created
        updatedAt:
          type: string
          format: date-time
          description: Timestamp when the post was last updated
      description: |-
        ExamplePost resource model

        Demonstrates a typical content resource with:
        - Multi-tenant scoping (orgId)
        - Status workflow (draft  published  archived)
        - Soft delete with restore capability
    ExamplePostListResponse:
      type: object
      required:
        - data
        - pagination
        - meta
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/ExamplePost'
        pagination:
          $ref: '#/components/schemas/Pagination'
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: Post collection response
    ExamplePostResponse:
      type: object
      required:
        - data
        - meta
      properties:
        data:
          $ref: '#/components/schemas/ExamplePost'
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: Single post response
    ExamplePostStatus:
      type: string
      enum:
        - draft
        - published
        - archived
      description: Post status enum
    File:
      type: object
      required:
        - id
        - filename
        - size
        - mimeType
        - storagePath
        - uploadedBy
        - uploadedAt
        - virusScanStatus
        - access
        - isDeleted
      properties:
        id:
          type: string
          description: 'Unique file identifier (format: file_abc123)'
          example: file_abc123
        filename:
          type: string
          description: Original filename (sanitized)
          example: report.pdf
        size:
          type: integer
          format: int64
          description: File size in bytes
          example: 2457600
        mimeType:
          type: string
          description: MIME type (verified via magic bytes, not client-provided)
          example: application/pdf
        storagePath:
          type: string
          description: Storage path (internal, not exposed to clients in production)
          example: orgs/org_abc123/files/file_abc123.pdf
        url:
          type: string
          description: Signed URL for file access (time-limited)
          example: https://cdn.example.com/files/file_abc123.pdf?signature=...
        metadata:
          type: object
          additionalProperties:
            type: string
          description: File metadata (user-provided)
        uploadedBy:
          type: string
          description: User ID who uploaded the file
          example: usr_xyz789
        uploadedAt:
          type: string
          format: date-time
          description: Timestamp when the file was uploaded
        virusScanStatus:
          allOf:
            - $ref: '#/components/schemas/VirusScanStatus'
          description: Virus scan status
        virusScanCompletedAt:
          type: string
          format: date-time
          description: Timestamp when virus scan completed
        access:
          allOf:
            - $ref: '#/components/schemas/FileAccess'
          description: Access level
        isDeleted:
          type: boolean
          description: Whether the file is soft deleted
        deletedAt:
          type: string
          format: date-time
          description: Timestamp when the file was deleted
        deletedBy:
          type: string
          description: User ID who deleted this file
      description: |-
        File resource model

        Represents an uploaded file with metadata, security status, and access info.
    FileAccess:
      type: string
      enum:
        - private
        - public
      description: File access level
    FileDeleteResponse:
      type: object
      required:
        - data
        - meta
      properties:
        data:
          type: object
          properties:
            id:
              type: string
              description: ID of the deleted file
            deletedAt:
              type: string
              format: date-time
              description: When the file was deleted
            deletedBy:
              type: string
              description: Who deleted the file
          required:
            - id
            - deletedAt
            - deletedBy
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: File deletion response
    FileListResponse:
      type: object
      required:
        - data
        - pagination
        - meta
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/File'
        pagination:
          $ref: '#/components/schemas/Pagination'
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: File list response with pagination
    FileResponse:
      type: object
      required:
        - data
        - meta
      properties:
        data:
          $ref: '#/components/schemas/File'
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: Single file response
    InitiateUploadRequest:
      type: object
      required:
        - filename
        - contentType
        - size
      properties:
        filename:
          type: string
          minLength: 1
          maxLength: 255
          description: Original filename
        contentType:
          type: string
          description: MIME type of the file
          example: application/pdf
        size:
          type: integer
          format: int64
          minimum: 1
          description: File size in bytes
        metadata:
          type: object
          additionalProperties:
            type: string
          description: Optional metadata
      description: Request to initiate a presigned URL upload
    InitiateUploadResponse:
      type: object
      required:
        - data
        - meta
      properties:
        data:
          type: object
          properties:
            uploadId:
              type: string
              description: Upload ID for confirmation step
              example: upl_xyz789
            presignedUrl:
              type: string
              description: Presigned URL to upload to
              example: https://s3.amazonaws.com/bucket/key?X-Amz-Algorithm=...
            method:
              type: string
              enum:
                - PUT
              description: HTTP method to use
            headers:
              type: object
              additionalProperties:
                type: string
              description: Required headers for the upload
            expiresAt:
              type: string
              format: date-time
              description: When the presigned URL expires
            maxSize:
              type: integer
              format: int64
              description: Maximum allowed file size
          required:
            - uploadId
            - presignedUrl
            - method
            - headers
            - expiresAt
            - maxSize
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: Response with presigned URL for direct upload to storage
    Job:
      type: object
      required:
        - jobId
        - tenantId
        - type
        - status
        - createdBy
        - createdAt
      properties:
        jobId:
          type: string
          description: 'Unique job identifier (format: job_abc123)'
          example: job_abc123
        tenantId:
          type: string
          description: Tenant this job belongs to
          example: org_xyz789
        type:
          type: string
          description: Type of operation (e.g., "bulkImport", "reportGeneration")
          example: bulkImport
        status:
          allOf:
            - $ref: '#/components/schemas/JobStatus'
          description: Current job status
        progress:
          type: integer
          format: int32
          minimum: 0
          maximum: 100
          description: Progress percentage (0-100, if available)
        message:
          type: string
          description: Human-readable status message
          example: Processing 150 of 500 records...
        result:
          type: object
          additionalProperties: {}
          description: Result data (when completed)
        error:
          type: object
          properties:
            code:
              type: string
              description: Error code
            message:
              type: string
              description: Error message
            details:
              type: object
              additionalProperties: {}
              description: Additional error details
          required:
            - code
            - message
          description: Error details (when failed)
        createdBy:
          type: string
          description: Who initiated the job
          example: usr_123
        createdAt:
          type: string
          format: date-time
          description: When the job was created
        startedAt:
          type: string
          format: date-time
          description: When the job started processing
        completedAt:
          type: string
          format: date-time
          description: When the job completed (success or failure)
        estimatedCompletion:
          type: string
          format: date-time
          description: Estimated completion time (if available)
      description: |-
        Async job resource

        Represents a long-running operation that can be polled for status.
    JobListResponse:
      type: object
      required:
        - data
        - pagination
        - meta
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/Job'
        pagination:
          $ref: '#/components/schemas/Pagination'
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: Job list response
    JobResponse:
      type: object
      required:
        - data
        - meta
      properties:
        data:
          $ref: '#/components/schemas/Job'
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: Job status response
    JobStatus:
      type: string
      enum:
        - pending
        - processing
        - completed
        - failed
        - cancelled
      description: Job status
    Pagination:
      type: object
      required:
        - page
        - pageSize
        - totalPages
        - totalCount
        - hasNext
        - hasPrevious
      properties:
        page:
          type: integer
          format: int32
          description: Current page number (1-indexed)
        pageSize:
          type: integer
          format: int32
          description: Number of items per page
        totalPages:
          type: integer
          format: int32
          description: Total number of pages
        totalCount:
          type: integer
          format: int32
          description: Total number of items across all pages
        hasNext:
          type: boolean
          description: Whether there is a next page
        hasPrevious:
          type: boolean
          description: Whether there is a previous page
        links:
          allOf:
            - $ref: '#/components/schemas/PaginationLinks'
          description: Navigation links for pagination
        requestedPageSize:
          type: integer
          format: int32
          description: Original requested page size (included if pageSize was capped)
      description: Page-based pagination metadata for collection responses
    PaginationLinks:
      type: object
      required:
        - first
        - previous
        - next
        - last
      properties:
        first:
          type: string
          nullable: true
          description: URL for the first page
        previous:
          type: string
          nullable: true
          description: URL for the previous page (null if on first page)
        next:
          type: string
          nullable: true
          description: URL for the next page (null if on last page)
        last:
          type: string
          nullable: true
          description: URL for the last page
      description: Pagination links for navigating through paginated results
    ResponseMeta:
      type: object
      required:
        - requestId
        - timestamp
      properties:
        requestId:
          type: string
          description: Unique request identifier for tracking and debugging
        timestamp:
          type: string
          format: date-time
          description: Timestamp when the response was generated
        apiVersion:
          type: string
          description: API version used for this request
        tenantId:
          type: string
          description: Tenant/organization ID for multi-tenant requests
        tenantName:
          type: string
          description: Tenant/organization name for multi-tenant requests
        durationMs:
          type: integer
          format: int32
          description: Processing time in milliseconds
      description: Response metadata included in all API responses
    Role:
      type: object
      required:
        - id
        - tenantId
        - name
        - permissions
        - isSystemRole
        - createdAt
        - updatedAt
      properties:
        id:
          type: string
          description: 'Unique role identifier (format: role_abc123)'
          example: role_admin
        tenantId:
          type: string
          description: Tenant this role belongs to
          example: org_abc123
        name:
          type: string
          description: Role name
          example: Admin
        description:
          type: string
          description: Role description
          example: Full administrative access
        permissions:
          type: array
          items:
            type: string
          description: 'Permissions granted by this role (format: resource:action)'
          example:
            - users:*
            - invoices:read
            - settings:admin
        isSystemRole:
          type: boolean
          description: Whether this is a system-defined role (cannot be deleted)
        createdAt:
          type: string
          format: date-time
          description: Timestamp when the role was created
        updatedAt:
          type: string
          format: date-time
          description: Timestamp when the role was last updated
      description: |-
        Role resource model

        Roles are tenant-scoped and contain a set of permissions.
    RoleListResponse:
      type: object
      required:
        - data
        - pagination
        - meta
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/Role'
        pagination:
          $ref: '#/components/schemas/Pagination'
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: Role list response
    RoleResponse:
      type: object
      required:
        - data
        - meta
      properties:
        data:
          $ref: '#/components/schemas/Role'
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: Single role response
    SoftDeleteResponse:
      type: object
      required:
        - data
        - meta
      properties:
        data:
          type: object
          properties:
            id:
              type: string
              description: ID of the deleted resource
            deletedAt:
              type: string
              format: date-time
              description: Timestamp when the resource was soft deleted
            deletedBy:
              type: string
              description: User ID who performed the deletion
            deletionReason:
              type: string
              description: Reason for deletion (optional, from request)
            canRestore:
              type: boolean
              description: Whether the resource can be restored
            restoreUntil:
              type: string
              format: date-time
              description: Deadline for restoration (after which hard delete may occur)
          required:
            - id
            - deletedAt
            - deletedBy
            - canRestore
        meta:
          allOf:
            - $ref: '#/components/schemas/ResponseMeta'
          description: Response metadata
      description: |-
        Response for soft delete operations

        Includes resource ID, deletion metadata, and restore information
    SwitchTenantRequest:
      type: object
      required:
        - tenantId
      properties:
        tenantId:
          type: string
          description: Target tenant ID
      description: Request to switch active tenant
    SwitchTenantResponse:
      type: object
      required:
        - data
        - meta
      properties:
        data:
          type: object
          properties:
            tenantId:
              type: string
              description: New active tenant ID
            tenantName:
              type: string
              description: Tenant name
            roles:
              type: array
              items:
                type: string
              description: Roles in the new tenant
            permissions:
              type: array
              items:
                type: string
              description: Permissions in the new tenant
            accessToken:
              type: string
              description: New access token scoped to the tenant
          required:
            - tenantId
            - tenantName
            - roles
            - permissions
            - accessToken
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: Tenant switch response with new token
    UpdateApiKeyRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 100
          description: Human-readable name
        description:
          type: string
          maxLength: 500
          description: Description
        permissions:
          type: array
          items:
            type: string
          description: Permissions (replaces existing)
        isActive:
          type: boolean
          description: Whether the key is active
      description: Request to update an API key
    UpdateExampleCommentRequest:
      type: object
      properties:
        content:
          type: string
          description: Comment content (optional)
      description: Request body for updating a comment
    UpdateExamplePostRequest:
      type: object
      properties:
        title:
          type: string
          description: Post title (optional)
        content:
          type: string
          description: Post content (optional)
        status:
          allOf:
            - $ref: '#/components/schemas/ExamplePostStatus'
          description: Post status (optional)
      description: Request body for updating a post
    UpdateRoleRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 100
          description: Role name
        description:
          type: string
          maxLength: 500
          description: Role description
        permissions:
          type: array
          items:
            type: string
          description: Permissions to grant
      description: Request to update a role
    UpdateUserRequest:
      type: object
      properties:
        name:
          type: string
          description: User's full name (optional)
        isActive:
          type: boolean
          description: Whether the user account is active (optional)
      description: Request body for updating a user
    UpdateWebhookRequest:
      type: object
      properties:
        url:
          type: string
          format: uri
          description: URL to receive webhook payloads
        name:
          type: string
          maxLength: 100
          description: Human-readable name
        description:
          type: string
          maxLength: 500
          description: Description
        events:
          type: array
          items:
            type: string
          description: Event types to subscribe to
        isActive:
          type: boolean
          description: Whether the webhook is active
      description: Request to update a webhook
    User:
      type: object
      required:
        - id
        - email
        - name
        - isActive
        - isVerified
        - isDeleted
        - createdAt
        - updatedAt
      properties:
        id:
          type: string
          description: 'Unique user identifier (format: usr_{randomString})'
          example: usr_abc123
        email:
          type: string
          description: User's email address
          example: john.doe@example.com
        name:
          type: string
          description: User's full name
          example: John Doe
        isActive:
          type: boolean
          description: Whether the user account is active
        isVerified:
          type: boolean
          description: Whether the user's email is verified
        isDeleted:
          type: boolean
          description: Whether the user is soft deleted
        deletedAt:
          type: string
          format: date-time
          description: Timestamp when the user was soft deleted (null if not deleted)
        deletedBy:
          type: string
          description: User ID who deleted this user (null if not deleted)
        createdAt:
          type: string
          format: date-time
          description: Timestamp when the user was created
        updatedAt:
          type: string
          format: date-time
          description: Timestamp when the user was last updated
        lastLoginAt:
          type: string
          format: date-time
          description: Timestamp of the user's last login (optional)
      description: User resource model
    UserListResponse:
      type: object
      required:
        - data
        - pagination
        - meta
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/User'
        pagination:
          $ref: '#/components/schemas/Pagination'
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: User collection response
    UserPermissions:
      type: object
      required:
        - userId
        - tenantId
        - roles
        - effectivePermissions
      properties:
        userId:
          type: string
          description: User ID
          example: usr_123
        tenantId:
          type: string
          description: Tenant ID
          example: org_abc123
        roles:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
                description: Role ID
              name:
                type: string
                description: Role name
              permissions:
                type: array
                items:
                  type: string
                description: Permissions from this role
            required:
              - id
              - name
              - permissions
          description: Roles assigned to the user
        effectivePermissions:
          type: array
          items:
            type: string
          description: Combined permissions from all roles (deduplicated, expanded)
          example:
            - users:read
            - users:write
            - users:delete
            - invoices:read
      description: User's permissions within a tenant
    UserPermissionsResponse:
      type: object
      required:
        - data
        - meta
      properties:
        data:
          $ref: '#/components/schemas/UserPermissions'
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: User permissions response
    UserResponse:
      type: object
      required:
        - data
        - meta
      properties:
        data:
          $ref: '#/components/schemas/User'
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: Single user response
    UserRole:
      type: object
      required:
        - userId
        - tenantId
        - roleId
        - roleName
        - assignedAt
        - assignedBy
      properties:
        userId:
          type: string
          description: User ID
          example: usr_123
        tenantId:
          type: string
          description: Tenant ID
          example: org_abc123
        roleId:
          type: string
          description: Role ID
          example: role_admin
        roleName:
          type: string
          description: Role name (denormalized for convenience)
          example: Admin
        assignedAt:
          type: string
          format: date-time
          description: When the role was assigned
        assignedBy:
          type: string
          description: Who assigned the role
          example: usr_owner
      description: User's role assignment within a tenant
    UserRoleResponse:
      type: object
      required:
        - data
        - meta
      properties:
        data:
          $ref: '#/components/schemas/UserRole'
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: User role assignment response
    UserTenantRoles:
      type: object
      required:
        - tenantId
        - tenantName
        - roles
      properties:
        tenantId:
          type: string
          description: Tenant ID
          example: org_abc123
        tenantName:
          type: string
          description: Tenant name
          example: Acme Corp
        roles:
          type: array
          items:
            type: string
          description: Role names in this tenant
          example:
            - admin
            - billing_manager
      description: User's roles across all tenants
    UserTenantRolesResponse:
      type: object
      required:
        - data
        - meta
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/UserTenantRoles'
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: User tenant roles response (all tenants)
    VirusScanStatus:
      type: string
      enum:
        - pending
        - scanning
        - clean
        - infected
        - failed
      description: Virus scan status for uploaded files
    Webhook:
      type: object
      required:
        - id
        - tenantId
        - url
        - events
        - secret
        - isActive
        - consecutiveFailures
        - createdBy
        - createdAt
        - updatedAt
      properties:
        id:
          type: string
          description: 'Unique webhook identifier (format: wh_abc123)'
          example: wh_abc123
        tenantId:
          type: string
          description: Tenant this webhook belongs to
          example: org_xyz789
        url:
          type: string
          description: URL to receive webhook payloads
          example: https://customer.com/webhooks/handler
        name:
          type: string
          description: Human-readable name for this webhook
          example: Production Webhook
        description:
          type: string
          description: Description of what this webhook is used for
        events:
          type: array
          items:
            type: string
          description: Event types to subscribe to (e.g., "user.created", "invoice.paid")
          example:
            - user.created
            - user.updated
            - invoice.paid
        secret:
          type: string
          description: Secret for HMAC-SHA256 signature verification (masked after creation)
          example: whsec_...xyz
        isActive:
          type: boolean
          description: Whether the webhook is currently active
        consecutiveFailures:
          type: integer
          format: int32
          description: Number of consecutive failures (resets on success)
        lastTriggeredAt:
          type: string
          format: date-time
          description: When the webhook was last triggered
        lastSuccessAt:
          type: string
          format: date-time
          description: When the webhook last succeeded
        lastFailureAt:
          type: string
          format: date-time
          description: When the webhook last failed
        createdBy:
          type: string
          description: User who created this webhook
          example: usr_admin123
        createdAt:
          type: string
          format: date-time
          description: When the webhook was created
        updatedAt:
          type: string
          format: date-time
          description: When the webhook was last updated
      description: |-
        Webhook configuration

        Defines an endpoint to receive event notifications.
    WebhookCreatedResponse:
      type: object
      required:
        - data
        - meta
      properties:
        data:
          $ref: '#/components/schemas/WebhookWithSecret'
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: Webhook creation response (includes secret once)
    WebhookDelivery:
      type: object
      required:
        - id
        - webhookId
        - eventId
        - eventType
        - status
        - attemptCount
        - createdAt
      properties:
        id:
          type: string
          description: 'Unique delivery identifier (format: whd_abc123)'
          example: whd_abc123
        webhookId:
          type: string
          description: Webhook ID this delivery belongs to
          example: wh_abc123
        eventId:
          type: string
          description: Event ID that triggered this delivery
          example: wh_evt_xyz789
        eventType:
          type: string
          description: Event type
          example: user.created
        status:
          allOf:
            - $ref: '#/components/schemas/WebhookDeliveryStatus'
          description: Delivery status
        attemptCount:
          type: integer
          format: int32
          description: Number of delivery attempts made
        httpStatus:
          type: integer
          format: int32
          description: HTTP status code from last attempt (null if not yet attempted)
        responseBody:
          type: string
          description: Response body from last attempt (truncated)
        errorMessage:
          type: string
          description: Error message if failed
        durationMs:
          type: integer
          format: int32
          description: Duration of last request in milliseconds
        nextRetryAt:
          type: string
          format: date-time
          description: When the next retry will be attempted
        createdAt:
          type: string
          format: date-time
          description: When this delivery was created
        lastAttemptAt:
          type: string
          format: date-time
          description: When the delivery was last attempted
        completedAt:
          type: string
          format: date-time
          description: When the delivery completed (success or exhausted)
      description: |-
        Webhook delivery attempt record

        Tracks each attempt to deliver a webhook payload.
    WebhookDeliveryListResponse:
      type: object
      required:
        - data
        - pagination
        - meta
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/WebhookDelivery'
        pagination:
          $ref: '#/components/schemas/Pagination'
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: Webhook delivery list response
    WebhookDeliveryResponse:
      type: object
      required:
        - data
        - meta
      properties:
        data:
          $ref: '#/components/schemas/WebhookDelivery'
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: Webhook delivery response
    WebhookDeliveryStatus:
      type: string
      enum:
        - pending
        - delivered
        - failed
        - exhausted
      description: Webhook delivery status
    WebhookEventTypesResponse:
      type: object
      required:
        - data
        - meta
      properties:
        data:
          type: object
          properties:
            eventTypes:
              type: object
              additionalProperties:
                type: array
                items:
                  type: string
              description: Available event types grouped by resource
          required:
            - eventTypes
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: Available webhook event types
    WebhookListResponse:
      type: object
      required:
        - data
        - pagination
        - meta
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/Webhook'
        pagination:
          $ref: '#/components/schemas/Pagination'
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: Webhook list response
    WebhookResponse:
      type: object
      required:
        - data
        - meta
      properties:
        data:
          $ref: '#/components/schemas/Webhook'
        meta:
          $ref: '#/components/schemas/ResponseMeta'
      description: Webhook response (secret masked)
    WebhookWithSecret:
      type: object
      required:
        - id
        - tenantId
        - url
        - events
        - secret
        - isActive
        - createdAt
      properties:
        id:
          type: string
          description: Unique webhook identifier
          example: wh_abc123
        tenantId:
          type: string
          description: Tenant this webhook belongs to
        url:
          type: string
          description: URL to receive webhook payloads
        name:
          type: string
          description: Webhook name
        events:
          type: array
          items:
            type: string
          description: Event types subscribed to
        secret:
          type: string
          description: |-
            The webhook secret - ONLY RETURNED ONCE
            Use this for signature verification
          example: whsec_abc123xyz789_secret
        isActive:
          type: boolean
          description: Whether the webhook is active
        createdAt:
          type: string
          format: date-time
          description: When the webhook was created
      description: Webhook with unmasked secret (only returned on creation)
servers:
  - url: https://api.example.com
    description: Production server
    variables: {}
  - url: http://localhost:3001
    description: Development server
    variables: {}
